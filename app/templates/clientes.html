{% extends "base.html" %}
{% block content %}
<div class="p-4 md:p-8 max-w-full">
  <!-- Header + Botón nuevo + Búsqueda -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-6">
    <h2 class="text-5xl md:text-6xl font-black text-cyan-400 tracking-tight">CLIENTES</h2>
    
    <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
      <!-- Barra de búsqueda -->
      <input type="text" id="buscarCliente" placeholder="Buscar por nombre o teléfono..." 
             class="px-6 py-4 text-lg rounded-full border-2 border-slate-300 focus:border-cyan-500 focus:outline-none shadow-md w-full sm:w-96
                    bg-white text-gray-900 placeholder-gray-500">
      
      <!-- Botón nuevo cliente -->
      <a href="/cliente/nuevo" 
         class="bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 
                text-white font-black text-xl px-10 py-4 rounded-full shadow-lg text-center
                transition transform hover:scale-105 active:scale-95 whitespace-nowrap">
        + NUEVO
      </a>
    </div>
  </div>

  <!-- Tabla de clientes -->
  <div class="overflow-x-auto -mx-4 md:mx-0">
    <div class="inline-block min-w-full align-middle">
      <div class="overflow-hidden rounded-xl shadow-2xl border border-slate-700">
        <table class="min-w-full divide-y divide-slate-700" id="tablaClientes">
          <thead class="bg-gradient-to-r from-cyan-600 to-blue-700">
            <tr>
              <th class="px-6 py-5 text-left text-lg font-bold text-white">Nombre del Cliente</th>
              <th class="px-6 py-5 text-center text-lg font-bold text-white">Teléfono</th>
              <th class="px-6 py-5 text-center text-lg font-bold text-white">Registrado el</th>
              <th class="px-6 py-5 text-center text-lg font-bold text-white">Acciones</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-700" id="filasClientes">
            {% for c in clientes %}
            <tr class="hover:bg-slate-700/50 transition">
              <td class="px-6 py-6 text-lg font-bold text-white">
                {{ c.nombre }}
              </td>
              <td class="px-6 py-6 text-center text-xl font-medium text-cyan-300">
                {{ c.telefono or 'Sin registro' }}
              </td>
              <td class="px-6 py-6 text-center text-base text-gray-300">
                {{ c.fecha.strftime('%d/%m/%Y') }}
              </td>
              <td class="px-6 py-6 text-center">
                <div class="flex justify-center gap-4">
                  <a href="/cliente/{{ c.id }}/editar"
                     class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold px-6 py-3 rounded-full text-base shadow-md transition">
                    Editar
                  </a>
                  {% if c.telefono and c.telefono|length > 5 %}
                  <a href="https://wa.me/52{{ c.telefono|replace(' ', '') }}?text=Hola%20{{ c.nombre.split()[0] }}%20%F0%9F%91%8B" 
                     target="_blank"
                     class="bg-green-500 hover:bg-green-600 text-white font-bold px-6 py-3 rounded-full text-base shadow-md transition">
                    WhatsApp
                  </a>
                  {% endif %}
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Mensaje cuando no hay clientes -->
  {% if clientes|length == 0 %}
  <div class="text-center py-32">
    <div class="bg-white/80 backdrop-blur rounded-3xl p-20 max-w-3xl mx-auto shadow-2xl border-4 border-dashed border-cyan-300">
      <h3 class="text-5xl md:text-6xl font-black text-slate-700 mb-8">
        No tienes clientes registrados
      </h3>
      <p class="text-2xl text-slate-600 mb-12">
        Comienza agregando tu primer cliente
      </p>
      <a href="/cliente/nuevo" 
         class="inline-block bg-gradient-to-r from-green-500 to-emerald-600 text-white font-black text-3xl px-16 py-8 rounded-full shadow-xl transition transform hover:scale-105">
        + Agregar cliente
      </a>
    </div>
  </div>
  {% endif %}
</div>

<!-- Script para búsqueda en tiempo real (nombre o teléfono) -->
<script>
  document.getElementById('buscarCliente').addEventListener('input', function() {
    const filtro = this.value.toLowerCase();
    const filas = document.querySelectorAll('#filasClientes tr');
    
    filas.forEach(fila => {
      const nombre = fila.cells[0].textContent.toLowerCase();
      const telefono = fila.cells[1].textContent.toLowerCase();
      if (nombre.includes(filtro) || telefono.includes(filtro)) {
        fila.style.display = '';
      } else {
        fila.style.display = 'none';
      }
    });
  });
</script>
{% endblock %}